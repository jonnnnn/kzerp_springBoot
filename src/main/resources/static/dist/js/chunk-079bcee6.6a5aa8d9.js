(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079bcee6","chunk-6592f2c4"],{"5cd4":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("d2-container",[r("el-collapse",{attrs:{slot:"header"},on:{change:e.collapseChange},slot:"header"},[r("el-collapse-item",[r("template",{slot:"title"},[e._v("\n\t\t\t\t查询条件\n\t\t\t\t"),r("i",{staticClass:"el-icon-d-arrow-right"})]),r("dynamic-form",{ref:"dataForm",attrs:{formprops:e.formprops,"col-span":"6,6,6,*",alldescriptors:e.descriptors},model:{value:e.dataForm,callback:function(t){e.dataForm=t},expression:"dataForm"}},[r("template",{slot:"btnsearch"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")]),r("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],2)],2)],1),r("vxe-grid",{ref:"pGrid",attrs:{border:"",resizable:"","highlight-current-row":"","remote-filter":"",size:"mini","row-id":"id",toolbar:e.toolbar,"proxy-config":e.tableProxy,columns:e.tableColumn,"select-config":{reserve:!0},"edit-config":{trigger:"click",mode:"row",showStatus:!0}},on:{"cell-dblclick":e.cellDblClick,"current-change":e.currentChange},scopedSlots:e._u([{key:"buttons",fn:function(){return[e.$hasPermission("inv:checkbill:save")?r("el-button",{ref:"btnStatusAdd",attrs:{size:"mini",icon:"el-icon-circle-plus",enablestatus:"NEW,COMPLETED"},on:{click:e.addHandle}},[e._v("新增\n\t\t\t")]):e._e(),e.$hasPermission("inv:checkbill:save")?r("el-button",{ref:"btnStatusEdit",attrs:{enablestatus:"NEW","row-dbclick":"","form-readonly":"",type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(t){return e.cellDblClick({row:e.$refs.pGrid.getCurrentRow()},t)}}},[e._v("修改\n\t\t\t")]):e._e(),e.$hasPermission("inv:checkbill:delete")?r("el-button",{ref:"btnStatusDelete",attrs:{enablestatus:"NEW",type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.deleteEntityHandle(e.$refs.pGrid)}}},[e._v("删除\n\t\t\t")]):e._e(),e.$hasPermission("inv:checkbill:submit")?r("el-button",{ref:"btnStatusSubmit",attrs:{enablestatus:"NEW",type:"success",size:"mini",icon:"el-icon-check"},on:{click:function(t){return e.submitHandle(e.$refs.pGrid,!0)}}},[e._v("提交\n\t\t\t")]):e._e(),r("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-printer"}},[e._v("打印\n\t\t\t")]),r("el-button",{attrs:{type:"info",size:"mini",icon:"fa fa-file-excel-o"},on:{click:function(t){return e.$refs.pGrid.exportCsv()}}},[e._v("导出\n\t\t\t")])]},proxy:!0}])}),r("el-pagination",{attrs:{slot:"footer","current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":function(t){return e.pageSizeChangeHandle(t,"vxe")},"current-change":function(t){return e.pageCurrentChangeHandle(t,"vxe")}},slot:"footer"}),e.addOrUpdateVisible?r("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.search}}):e._e()],1)},i=[],o=r("a460"),n=r("e1a58"),l={name:"inv-checkbill",mixins:[n["a"]],data:function(){return{mixinViewModuleOptions:{getDataListURL:"/inv/checkbill/list",getDataListIsPage:!0,updateURL:"/inv/checkbill/save",submitURL:"/inv/checkbill/submit",deleteIsBatch:!0,exportURL:"/inv/checkbill/export"},order:"desc",orderField:"id",dataForm:{orderNum:"",warehouseId:"",status:""},descriptors:{orderNum:{type:"string",label:"盘点单号",props:{clearable:!0}},warehouseId:{type:"cust",label:"仓库",ruletype:"integer",name:"im-selector",props:{mapKeyVal:"warehouseCode:warehouseId",dataType:"biz.warehouse",clearable:!0}},status:{type:"cust",label:"单据状态",placeholder:"请选择状态",name:"im-selector",props:{mapKeyVal:"status",dataType:"code.status",clearable:!0}},separate1:this.$g.separate,pic:{type:"cust",label:"负责人",name:"im-selector",props:{mapKeyVal:"picName:pic",dataType:"biz.employee",clearable:!0}},checkDate:{type:"date",label:"盘点日期",colspan:2,props:{type:"daterange",rangeSeparator:"至",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"yyyy-MM-dd",class:"input-class"}},btnSearch:{type:"slot",name:"btnsearch"}},tableColumn:[{type:"index",width:30,align:"center"},{title:"盘点单号",field:"orderNum",sortable:!0,align:"center"},{title:"公司",field:"companyName",sortable:!0,align:"center"},{title:"仓库",field:"warehouseCode",sortable:!0,align:"center"},{title:"盘点日期",field:"checkDate",sortable:!0,align:"center",formatter:["toDateString","yyyy-MM-dd"]},{title:"负责人",field:"picName",sortable:!0,align:"center"},{title:"状态",field:"statusMean",sortable:!0,align:"center"},{title:"备注",field:"remark",sortable:!0,align:"center"},{title:"修改人",field:"updateBy",sortable:!0,align:"center"},{title:"修改日期",field:"updateDate",sortable:!0,align:"center",formatter:["toDateString","yyyy-MM-dd"]}],toolbar:{id:"full_edit_1",refresh:!0,resizable:{storage:!0},setting:{storage:!0}}}},components:{AddOrUpdate:o["default"]},methods:{reset:function(){this.$refs.dataForm.resetFields()}},mounted:function(){}},s=l,c=r("623f"),d=function(e){e.options.__source="src/views/inv/checkbill.vue"},u=d,p=Object(c["a"])(s,a,i,!1,null,null,null);"function"===typeof u&&u(p);t["default"]=p.exports},"9d30":function(e,t,r){var a=r("e46b");a(a.S,"Number",{isNaN:function(e){return e!=e}})},a460:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"abow_dialog",attrs:{title:e.isNew?"盘点单新增":"盘点单修改","close-on-click-modal":!1,visible:e.visible,width:"80%"},on:{"update:visible":function(t){e.visible=t}}},[r("div",[r("dynamic-form",{ref:"dataForm",attrs:{formprops:e.formprops,"col-span":"8,8,8","read-only":e.formReadOnly,alldescriptors:e.descriptors},model:{value:e.dataForm,callback:function(t){e.dataForm=t},expression:"dataForm"}})],1),r("vxe-grid",{ref:"sGrid",staticClass:"vxe-table-element",attrs:{border:"",resizable:"",size:"mini","highlight-current-row":"","remote-filter":"",toolbar:e.toolbar,"proxy-config":e.tableProxy,"edit-rules":e.validRules,columns:e.tableColumn,"select-config":{reserve:!0},"mouse-config":{selected:!0},"keyboard-config":{isArrow:!0,isDel:!0,isTab:!0,isEdit:!0},"edit-config":{trigger:"dblclick",mode:"cell"},"footer-cell-class-name":e.footerCellClassName,"footer-method":e.footerMethod,"show-footer":""},scopedSlots:e._u([{key:"buttons",fn:function(){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus"},on:{click:function(t){return e.$refs.sGrid.commitProxy("insert_actived")}}},[e._v("新增")]),r("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.removeSelecteds(e.$refs.sGrid)}}},[e._v("删除")])]},proxy:!0}])}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),r("el-button",{directives:[{name:"show",rawName:"v-show",value:e.enableSubmit,expression:"enableSubmit"}],attrs:{type:"primary",disabled:e.btnDisable},on:{click:e.dataFormSubmit}},[e._v("确定")])],1)],1)},i=[],o=(r("163d"),r("9d30"),r("289c")),n=r("e1a58"),l=r("be17"),s=r.n(l),c={type:"separate"},d={mixins:[n["a"]],data:function(){var e;return{mixinViewModuleOptions:{getDataListURL:"/inv/checkbillline/list",updateURL:"/inv/checkbill/save",prodURL:"/base/product/search",getDataListIsPage:!1,activatedIsNeed:!1},visible:!1,btnDisable:!1,dataForm:{warehouseId:"",pic:"",remark:"",warehouseCode:"",picName:""},descriptors:{orderNum:{type:"string",label:"盘点单号",disabled:"disabled",props:{clearable:!0}},warehouseId:(e={type:"cust",label:"仓库",ruletype:"integer",required:!0,message:"仓库不能为空"},Object(o["a"])(e,"ruletype","integer"),Object(o["a"])(e,"name","im-selector"),Object(o["a"])(e,"props",{mapKeyVal:"warehouseCode:warehouseId",dataType:"biz.warehouse",clearable:!0}),e),pic:{type:"cust",label:"负责人",required:!0,name:"im-selector",props:{mapKeyVal:"picName:pic",dataType:"biz.employee",clearable:!0}},separate1:c,remark:{type:"string",label:"备注",colspan:3}},tableProxy:{autoLoad:!1},validRules:{productCode:[{required:!0,message:"物料必填"}],quantityNew:[{required:!0,message:"盘点数量必填"},{type:"number",message:"请输入数字"}]},tableColumn:[{type:"selection",width:30,align:"center"},{type:"index",width:30,align:"center"},{title:"商品",field:"productCode",sortable:!0,align:"center",editRender:{name:"ElAutocomplete",props:{fetchSuggestions:this.prodSeach,triggerOnFocus:!1,popperClass:"prod-popper"},events:{select:this.handleProcSelect}},footerRender:function(e,t){return"汇总"}},{title:"单位",field:"uom",sortable:!0,align:"center"},{title:"盘点数量",field:"quantityNew",sortable:!0,align:"center",editRender:{name:"input",autoselect:!0},footerRender:function(e,t){return s.a.sum(t,e.property)}},{title:"帐面数量",field:"quantityOld",sortable:!0,align:"center",footerRender:function(e,t){return s.a.sum(t,e.property)}},{title:"差异数",field:"orderQty",sortable:!0,align:"center",editPost:function(e,t){var r=t.quantityNew,a=t.quantityOld;if(!Number.isNaN(r))return r-Number(a)},footerRender:function(e,t){return s.a.sum(t,e.property)}},{title:"差异原因",field:"diffCause",sortable:!0,align:"center",editRender:{name:"input",autoselect:!0}},{title:"备注",field:"remark",sortable:!0,align:"center",editRender:{name:"input",autoselect:!0}}],toolbar:{id:"full_edit_1",resizable:{storage:!0},setting:{storage:!0}}}},methods:{prodSeach:function(e,t){var r=this;e&&this.$axios.post(this.mixinViewModuleOptions.prodURL,{name:e,warehouseId:this.dataForm.warehouseId}).then((function(e){for(var a=0;a<e.length;a++)e[a].value=e[a].val;clearTimeout(r.timeout),r.timeout=setTimeout((function(){t(e)}),100*Math.random())}))},handleProcSelect:function(e,t){var r=e.row;t&&(Object.assign(r,t),r.quantityOld=t.stock,r.uom=t.unit,r.productId=t.id,r.productCode=t.code)},initCB:function(){var e=this;this.$nextTick((function(){e.isNew||"NEW"==e.entityModel.status?e.$refs.dataForm.readOnly(!1):e.$refs.dataForm.readOnly(!0)}))}},mounted:function(){}},u=d,p=r("623f"),m=function(e){e.options.__source="src/views/inv/checkbill-add-or-update.vue"},b=m,f=Object(p["a"])(u,a,i,!1,null,null,null);"function"===typeof b&&b(f);t["default"]=f.exports}}]);